# RL
- $MRP = <\mathcal{S,P,R},\gamma>$

- $ MDP=<\mathcal{S,A,P,R},\gamma>$

---
# MRP
- $ \mathcal{P}_{ss'}=\mathbb{P}[S_{t+1}=s'|S_t=s] $

- $\mathcal{R}_s=\mathbb{E}[{R}_{t+1}|S_t=s]$

- return $G_t=R_{t+1}+\gamma{R_{t+2}}+...=\sum_{k=0}^{\infty}\gamma^kR_{t+k+1}$

- $v(s)=\mathbb{E}[G_t|S_t=s]$

- Bellman Equation for MRPs
 \begin{equation}\begin{aligned}v(s)&=\mathbb{E}[G_t|S_t=s]\\&=\mathbb{E}[R_{t+1}+\gamma R_{t+2}+\gamma^2R_{t+3}+\dots|S_t=s]\\&=\mathbb{E}[R_{t+1}+\gamma\sum_{k=0}^{\infty}\gamma^kR_{t+k+2}|S_t=s]\\&=\mathcal{R}_s+\gamma\mathbb{E}\sum_{k=0}^{\infty}\gamma^kR_{t+k+2}|S_t=s]\\&=\mathcal{R}_s+\gamma\mathbb{E}\sum_{s'}\mathcal{P}_{ss'}\mathbb{E}[\sum_{k=0}^{\infty}\gamma^kR_{t+k+2}|S_t=s,S_{t+1}=s']\\&=\mathcal{R}_s+\gamma\mathbb{E}\sum_{s'}\mathcal{P}_{ss'}\mathbb{E}[\sum_{k=0}^{\infty}\gamma^kR_{t+k+2}|S_{t+1}=s']\\&=\mathcal{R}_s+\gamma\sum_{s'}\mathcal{P}_{ss'}v(s')\end{aligned} \end{equation}
\begin{equation}\begin{bmatrix}v(1)\\ \vdots\\v(n)\end{bmatrix}=\begin{bmatrix}\mathcal{R_1\\\vdots\\R_n}\end{bmatrix}+\begin{bmatrix}\mathcal{P_{11},\dots,P_{1n}\\\vdots\\P_{n1},\dots,P_{nn}}\end{bmatrix}\begin{bmatrix}{v(1)\\\vdots\\v(n)}\end{bmatrix}\end{equation}
i.e.\begin{equation}v=\mathcal{R}+\gamma\mathcal{P}v\end{equation}

---
# MDP
- $\mathcal{P}_{ss'}^a=\mathbb{P}[S_{t+1}=s'|S_t=s',A_t=s']$

- $\mathcal{R}_s^a=\mathbb{E}[R_{t+1}|S_t=s,A_t=a]$

- A policy $\pi$ is a distribution over actions given states,
\begin{equation}\pi(a|s)=\mathbb{P}(A_t=a|S_t=s)\end{equation}

- $\mathcal{P}_{ss'}^{\pi}=\sum_{a\in A}\pi(a|s)\mathcal{P}_{ss'}^a$

- $\mathcal{R}_s^\pi=\sum_{a\in A}\pi(a|s)\mathcal{R}_s^a$

- $v_\pi(s)=\mathbb{E}_\pi[G_t|S_t=s]$

- $q_\pi(a,s)=\mathbb{E}[G_{t+1}|S_t=s,A_t=a]$

## Bellman Expectation Equation
$v_\pi(s)=\sum_{a\in A}\pi(a|s)q_\pi(s,a)$  

$q_\pi(s,a)=\mathcal{R}_s^a+\gamma\sum_{s'}\mathcal{P}_{ss'}^av_\pi(s')$

Bellman Expectation Equation for $v_\pi$:
\begin{equation}v_\pi(s)=\sum_{a\in A}\pi(a|s)(R_s^a+\gamma\sum_{s'\in S}\mathcal{P}_{ss'}^av_\pi(s'))\end{equation}
Bellman Expectation Equation for $q_\pi$:
\begin{equation}q_\pi(s,a)=\mathcal{R}_s^a+\gamma\sum_{s'\in S}\mathcal{P}_{ss'}^a\sum_{a'\in A}\pi(s'|a')q_\pi(s',a')\end{equation}
####  Matrix Form:
\begin{equation}v_\pi=\mathcal{R}^\pi+\gamma\mathcal{P}v_\pi\end{equation}


